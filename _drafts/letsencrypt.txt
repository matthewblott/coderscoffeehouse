# The aspnet docs say nginx should be compiled with the ssl module because it's not included with the default install but this appears to be incorrect. If you run nginx -V and can see "--with-http_ssl_module" then it's installed.

# view the certificates and check it matches
openssl x509 -in $name.crt -text

# to get rid of the red cross through https (Always Trust)
# see https://peteskelly.com/testing-ssl-in-asp-net-core-mac/amp/ 

# create /etc/nginx/proxy.conf
proxy_redirect       off;
proxy_set_header     Host       $host;
proxy_set_header    X-Real-IP     $remote_addr;
proxy_set_header    X-Forwarded-For  $proxy_add_x_forwarded_for;
proxy_set_header    X-Forwarded-Proto $scheme;
client_max_body_size   10m;
client_body_buffer_size 128k;
proxy_connect_timeout   90;
proxy_send_timeout     90;
proxy_read_timeout     90;
proxy_buffers      32 4k;

# add the following line below http to /etc/nginx/nginx.conf
include    /etc/nginx/proxy.conf;
